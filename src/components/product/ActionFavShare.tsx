'use client';
import { useUpdateFavorite } from '@/hooks/favorites/useUpdateFavorite';
import { useSession } from '@/lib/auth/useSession';
import { BASEURL_SITE } from '@/lib/variable';
import { Product } from '@/store/types/home';
import { addToast } from '@heroui/react';
import { useState } from 'react';
import BaseDialog from '../common/BaseDialog';
import Button from '../common/Button';
import { useGetFavorites } from '@/hooks/favorites/services/useGetFavorites';

const ActionFavShare = ({ product }: { product: Product }) => {
  const { updateFavorite } = useUpdateFavorite();
  const { data } = useGetFavorites();
  const user = useSession();
  const [openShare, setOpenShare] = useState(false);
  const onToggleShare = () => setOpenShare(!openShare);
  const onCopy = () => {
    setOpenShare(false);
    navigator.clipboard.writeText(`${BASEURL_SITE}/product/${product.url}`);
    addToast({
      title: `لینک محصول با موفقیت کپی شد`,
      color: 'success',
      classNames: {
        base: '!z-[9999]',
      },
    });
  };
  const datafavorites = data?.data.data;
  const favorirtes = [
    ...(Array.isArray(datafavorites?.physical) ? datafavorites?.physical : []),
    ...(Array.isArray(datafavorites?.digital) ? datafavorites?.digital : []),
  ];
  const isBookmark = favorirtes?.find((item) => item?.item?._id === product._id);
  console.log(isBookmark, 'isBookmark');
  return (
    <div>
      <div className="absolute right-0 top-0 z-30 flex flex-row gap-3 lg:mr-3 lg:flex-col lg:gap-0">
        <Button
          onClick={() => updateFavorite(product._id, isBookmark)}
          className="w-fit !min-w-fit px-0"
        >
          <span>
            {isBookmark ? (
              <svg
                stroke="currentColor"
                fill="#6A7890"
                stroke-width="0"
                viewBox="0 0 512 512"
                height="24px"
                width="24px"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path d="M400 480a16 16 0 0 1-10.63-4L256 357.41 122.63 476A16 16 0 0 1 96 464V96a64.07 64.07 0 0 1 64-64h192a64.07 64.07 0 0 1 64 64v368a16 16 0 0 1-16 16z"></path>
              </svg>
            ) : (
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M6 2.5H18C18.1326 2.5 18.2597 2.55272 18.3535 2.64648C18.4473 2.74025 18.5 2.86739 18.5 3V21C18.499 21.0978 18.4697 21.1933 18.415 21.2744C18.36 21.3561 18.2815 21.4195 18.1904 21.457L18.1777 21.4619L18.167 21.4678C18.119 21.4904 18.0658 21.5014 18.0127 21.5H17.9971C17.9313 21.5004 17.8656 21.4878 17.8047 21.4629C17.7441 21.4381 17.6891 21.4015 17.6426 21.3555L17.627 21.3408L17.6113 21.3271L12.3213 16.8867L12 16.6172L11.6787 16.8867L6.32812 21.377L6.3252 21.3799C6.25256 21.442 6.16304 21.482 6.06836 21.4951C5.97385 21.5082 5.87769 21.494 5.79102 21.4541C5.7042 21.4141 5.63065 21.35 5.5791 21.2695C5.52757 21.189 5.49999 21.0956 5.5 21V3C5.5 2.86739 5.55272 2.74025 5.64648 2.64648C5.74025 2.55272 5.86739 2.5 6 2.5ZM6.5 19.9326L7.32129 19.2432L11.6807 15.582C11.7703 15.508 11.8837 15.4688 12 15.4688C12.116 15.4688 12.2288 15.5083 12.3184 15.582V15.583L16.6787 19.2432L17.5 19.9326V3.5H6.5V19.9326Z"
                  fill="black"
                  stroke="#6A7890"
                />
              </svg>
            )}
          </span>
        </Button>
        <Button onClick={onToggleShare} className="w-fit !min-w-fit px-0">
          <span>
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M9 12C9 13.3807 7.88071 14.5 6.5 14.5C5.11929 14.5 4 13.3807 4 12C4 10.6193 5.11929 9.5 6.5 9.5C7.88071 9.5 9 10.6193 9 12Z"
                stroke="#7D8793"
                strokeWidth="1.5"
              />
              <path d="M14 6.5L9 10" stroke="#7D8793" strokeWidth="1.5" strokeLinecap="round" />
              <path d="M14 17.5L9 14" stroke="#7D8793" strokeWidth="1.5" strokeLinecap="round" />
              <path
                d="M19 18.5C19 19.8807 17.8807 21 16.5 21C15.1193 21 14 19.8807 14 18.5C14 17.1193 15.1193 16 16.5 16C17.8807 16 19 17.1193 19 18.5Z"
                stroke="#7D8793"
                strokeWidth="1.5"
              />
              <path
                d="M19 5.5C19 6.88071 17.8807 8 16.5 8C15.1193 8 14 6.88071 14 5.5C14 4.11929 15.1193 3 16.5 3C17.8807 3 19 4.11929 19 5.5Z"
                stroke="#7D8793"
                strokeWidth="1.5"
              />
            </svg>
          </span>
        </Button>
        {/* <Button onClick={() => setComingSoon(true)} className="w-fit !min-w-fit px-0">
          <span>
            {user?.discountNotification?.includes(product._id) ? (
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M5.40875 12.4274L5.40878 12.4274L5.41171 12.4224C5.56188 12.1659 5.69097 11.8204 5.78227 11.4888C5.87345 11.1576 5.9402 10.792 5.9402 10.4898V8.6298C5.9402 5.27743 8.66502 2.55942 12.0209 2.5498C15.3639 2.55018 18.0902 5.27568 18.0902 8.6298V10.4998C18.0902 10.8022 18.157 11.1681 18.2499 11.5006C18.3425 11.8323 18.4748 12.1797 18.6324 12.4387C18.6327 12.4392 18.633 12.4396 18.6333 12.4401L19.7604 14.3152C19.7606 14.3155 19.7607 14.3159 19.7609 14.3162C20.0945 14.8783 20.1574 15.5393 19.9323 16.1436C19.7047 16.7445 19.2271 17.2141 18.6011 17.4258C17.5449 17.7778 16.4616 18.0508 15.3709 18.2261L15.3708 18.226L15.3608 18.2279C15.2469 18.2486 15.1589 18.2642 15.0749 18.2719L15.0564 18.2735L15.038 18.2766C14.8737 18.304 14.7072 18.3226 14.525 18.3429L14.525 18.3427L14.5126 18.3444C14.3069 18.3725 14.0893 18.3915 13.8569 18.4117L13.8569 18.4117L13.852 18.4121C13.2484 18.4706 12.6344 18.4998 12.0202 18.4998C11.3957 18.4998 10.7716 18.4705 10.1576 18.4121L10.1576 18.4119L10.1471 18.4112C9.89055 18.3922 9.64359 18.3637 9.39623 18.3256L9.39625 18.3255L9.38629 18.3242C9.23898 18.3046 9.09446 18.2853 8.95969 18.2661C8.89722 18.255 8.8367 18.2467 8.78685 18.2399L8.78276 18.2394C8.72599 18.2316 8.68194 18.2256 8.63965 18.2179L8.63965 18.2178L8.63456 18.217C7.54582 18.0306 6.48087 17.7763 5.42832 17.4254L5.42475 17.4243C4.76204 17.2089 4.27316 16.735 4.05916 16.1564L4.05837 16.1542C3.84876 15.5953 3.91654 14.9234 4.27995 14.3054L5.40875 12.4274ZM11.9902 11.2598C12.6863 11.2598 13.2502 10.6959 13.2502 9.9998V6.89981C13.2502 6.20366 12.6863 5.6398 11.9902 5.6398C11.2941 5.6398 10.7302 6.20366 10.7302 6.89981V9.9998C10.7302 10.6959 11.2941 11.2598 11.9902 11.2598Z"
                  fill="#DD338B"
                  stroke="#DD338B"
                />
                <path
                  d="M10.0952 20.6143C10.1457 20.6193 10.1963 20.6239 10.2471 20.6282C10.8286 20.6792 11.423 20.71 12.0197 20.71C12.607 20.71 13.1921 20.6791 13.7642 20.628L13.7642 20.628L13.7671 20.6277C13.8101 20.6237 13.8577 20.6197 13.9083 20.6156C13.4471 21.1572 12.7618 21.5 11.9997 21.5C11.3408 21.5 10.6921 21.2319 10.2395 20.7628L10.2308 20.7538L10.2217 20.7452C10.1779 20.7042 10.1357 20.6604 10.0952 20.6143Z"
                  fill="#DD338B"
                  stroke="#DD338B"
                />
              </svg>
            ) : (
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M12 6.43994V9.76994"
                  stroke="#7D8793"
                  strokeWidth="1.5"
                  strokeMiterlimit="10"
                  strokeLinecap="round"
                />
                <path
                  d="M12.0209 2C8.34087 2 5.36087 4.98 5.36087 8.66V10.76C5.36087 11.44 5.08087 12.46 4.73087 13.04L3.46087 15.16C2.68087 16.47 3.22087 17.93 4.66087 18.41C9.44087 20 14.6109 20 19.3909 18.41C20.7409 17.96 21.3209 16.38 20.5909 15.16L19.3209 13.04C18.9709 12.46 18.6909 11.43 18.6909 10.76V8.66C18.6809 5 15.6809 2 12.0209 2Z"
                  stroke="#7D8793"
                  strokeWidth="1.5"
                  strokeMiterlimit="10"
                  strokeLinecap="round"
                />
                <path
                  d="M15.3299 18.8199C15.3299 20.6499 13.8299 22.1499 11.9999 22.1499C11.0899 22.1499 10.2499 21.7699 9.64992 21.1699C9.04992 20.5699 8.66992 19.7299 8.66992 18.8199"
                  stroke="#7D8793"
                  strokeWidth="1.5"
                  strokeMiterlimit="10"
                />
              </svg>
            )}
          </span>
        </Button> */}
      </div>

      {/* share */}

      <BaseDialog isOpen={openShare} title="اشتراک‌گذاری" size="md" onClose={onToggleShare}>
        <div className="flex flex-col items-center justify-center">
          <span>
            <svg
              width="64"
              height="64"
              viewBox="0 0 64 64"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                opacity="0.4"
                d="M24.0007 5.33331C17.014 5.33331 11.334 11.0133 11.334 18C11.334 24.8533 16.694 30.4 23.6807 30.64C23.894 30.6133 24.1073 30.6133 24.2673 30.64C24.3207 30.64 24.3473 30.64 24.4007 30.64C24.4273 30.64 24.4273 30.64 24.454 30.64C31.2807 30.4 36.6407 24.8533 36.6673 18C36.6673 11.0133 30.9873 5.33331 24.0007 5.33331Z"
                fill="#6E3DFF"
              />
              <path
                d="M37.5466 37.7333C30.1066 32.7733 17.9732 32.7733 10.4799 37.7333C7.09323 40 5.22656 43.0666 5.22656 46.3466C5.22656 49.6266 7.09323 52.6666 10.4532 54.9066C14.1866 57.4133 19.0932 58.6666 23.9999 58.6666C28.9066 58.6666 33.8132 57.4133 37.5466 54.9066C40.9066 52.64 42.7732 49.6 42.7732 46.2933C42.7466 43.0133 40.9066 39.9733 37.5466 37.7333Z"
                fill="#6E3DFF"
              />
              <path
                opacity="0.4"
                d="M53.307 19.5733C53.7336 24.7467 50.0536 29.28 44.9603 29.8933C44.9336 29.8933 44.9336 29.8933 44.907 29.8933H44.827C44.667 29.8933 44.507 29.8933 44.3736 29.9467C41.787 30.08 39.4136 29.2533 37.627 27.7333C40.3736 25.28 41.947 21.6 41.627 17.6C41.4403 15.44 40.6936 13.4667 39.5736 11.7867C40.587 11.28 41.7603 10.96 42.9603 10.8533C48.187 10.4 52.8536 14.2933 53.307 19.5733Z"
                fill="#6E3DFF"
              />
              <path
                d="M58.64 44.24C58.4266 46.8267 56.7733 49.0667 54 50.5867C51.3333 52.0533 47.9733 52.7467 44.64 52.6667C46.56 50.9333 47.68 48.7733 47.8933 46.48C48.16 43.1733 46.5866 40 43.44 37.4667C41.6533 36.0533 39.5733 34.9333 37.3066 34.1067C43.2 32.4 50.6133 33.5467 55.1733 37.2267C57.6266 39.2 58.88 41.68 58.64 44.24Z"
                fill="#6E3DFF"
              />
            </svg>
          </span>
          <p className="mt-[20px] font-medium text-[16px] text-[#0C0C0C]">
            این کالا را با دوستان خود به اشتراک بگذارید!
          </p>
          <Button onClick={onCopy} className="mt-5 border border-dashed text-main">
            <span>
              <svg
                width="25"
                height="24"
                viewBox="0 0 25 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M11.6 22.75H7.4C3.49 22.75 1.75 21.01 1.75 17.1V12.9C1.75 8.99 3.49 7.25 7.4 7.25H11.6C15.51 7.25 17.25 8.99 17.25 12.9V17.1C17.25 21.01 15.51 22.75 11.6 22.75ZM7.4 8.75C4.3 8.75 3.25 9.8 3.25 12.9V17.1C3.25 20.2 4.3 21.25 7.4 21.25H11.6C14.7 21.25 15.75 20.2 15.75 17.1V12.9C15.75 9.8 14.7 8.75 11.6 8.75H7.4Z"
                  fill="#6E3DFF"
                />
                <path
                  d="M17.6 16.75H16.5C16.09 16.75 15.75 16.41 15.75 16V12.9C15.75 9.8 14.7 8.75 11.6 8.75H8.5C8.09 8.75 7.75 8.41 7.75 8V6.9C7.75 2.99 9.49 1.25 13.4 1.25H17.6C21.51 1.25 23.25 2.99 23.25 6.9V11.1C23.25 15.01 21.51 16.75 17.6 16.75ZM17.25 15.25H17.6C20.7 15.25 21.75 14.2 21.75 11.1V6.9C21.75 3.8 20.7 2.75 17.6 2.75H13.4C10.3 2.75 9.25 3.8 9.25 6.9V7.25H11.6C15.51 7.25 17.25 8.99 17.25 12.9V15.25Z"
                  fill="#6E3DFF"
                />
              </svg>
            </span>
            <span>کپی لینک</span>
          </Button>
        </div>
      </BaseDialog>
    </div>
  );
};

export default ActionFavShare;
